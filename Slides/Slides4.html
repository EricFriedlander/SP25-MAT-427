<!DOCTYPE html>
<html lang="en"><head>
<script src="Slides4_files/libs/clipboard/clipboard.min.js"></script>
<script src="Slides4_files/libs/quarto-html/tabby.min.js"></script>
<script src="Slides4_files/libs/quarto-html/popper.min.js"></script>
<script src="Slides4_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Slides4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Slides4_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Slides4_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Slides4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.555">

  <meta name="author" content="Eric Friedlander   Much of the content in these slides have been adapted from Abhishek Chakraborty at Lawrence University">
  <title>MATH 427: Machine Learning</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Slides4_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Slides4_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Slides4_files/libs/revealjs/dist/theme/quarto.css">
  <link href="Slides4_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Slides4_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Slides4_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Slides4_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">MATH 427: Machine Learning</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Eric Friedlander <br> <span class="smaller">Much of the content in these slides have been adapted from Abhishek Chakraborty at Lawrence University</span> 
</div>
</div>
</div>

</section>
<section id="classification-problems" class="slide level2 smaller">
<h2>Classification Problems</h2>
<ul>
<li>Response <span class="math inline">\(Y\)</span> is qualitative (categorical).
<ul>
<li>Only two classes <span class="math inline">\(\implies\)</span> <strong>Binary Classification Problem</strong></li>
</ul></li>
<li><strong>Objectives</strong>: build a classifier <span class="math inline">\(\hat{Y}=\hat{C}(\mathbf{X})\)</span> that:
<ul>
<li>assigns a class label to a future unlabeled (unseen) observation</li>
<li>helps understand the relationship between the predictors and response</li>
</ul></li>
<li>There can be two types of predictions based on the research problem.
<ul>
<li>Class probabilities</li>
<li>Class labels</li>
</ul></li>
</ul>
</section>
<section id="classification-problem-default-dataset" class="slide level2 smaller">
<h2><span class="r-fit-text">Classification Problem: Default Dataset</span></h2>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">library</span>(ISLR2)   <span class="co"># load library</span></span>
<span id="cb1-2"><a href=""></a><span class="fu">data</span>(<span class="st">"Default"</span>)   <span class="co"># load dataset</span></span>
<span id="cb1-3"><a href=""></a></span>
<span id="cb1-4"><a href=""></a><span class="fu">head</span>(Default) <span class="sc">|&gt;</span>   <span class="co"># print first six observations</span></span>
<span id="cb1-5"><a href=""></a>  <span class="fu">kable</span>()         <span class="co"># Make it look pretty</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">default</th>
<th style="text-align: left;">student</th>
<th style="text-align: right;">balance</th>
<th style="text-align: right;">income</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">729.5265</td>
<td style="text-align: right;">44361.625</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">817.1804</td>
<td style="text-align: right;">12106.135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1073.5492</td>
<td style="text-align: right;">31767.139</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">529.2506</td>
<td style="text-align: right;">35704.494</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">785.6559</td>
<td style="text-align: right;">38463.496</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">919.5885</td>
<td style="text-align: right;">7491.559</td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div class="column">
<p><strong>Response Variable</strong>: <code>default</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a>Default <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href=""></a>  <span class="fu">count</span>(default) <span class="sc">|&gt;</span>  <span class="co"># class frequencies</span></span>
<span id="cb2-3"><a href=""></a>  <span class="fu">kable</span>()           <span class="co"># Make it look nice</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">default</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">9667</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">333</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="k-nearest-neighbors-classifier" class="slide level2">
<h2>K-Nearest Neighbors Classifier</h2>
<ul>
<li>Given a value for <span class="math inline">\(K\)</span> and a test data point <span class="math inline">\(x_0\)</span>: <span class="math display">\[P(Y=j | X=x_0)=\dfrac{1}{K} \sum_{x_i \in \mathcal{N}_0} I(y_i = j)\]</span> where <span class="math inline">\(\mathcal{N}_0\)</span> is the set of the <span class="math inline">\(K\)</span> ‚Äúclosest‚Äù neighbors.</li>
<li>For classification: neighbors ‚Äúvote‚Äù for class (unlike in regression where predictions are obtained by averaging) <span class="math display">\[P(Y=j | X=x_0)=\text{Proportion of neighbors in class }j\]</span></li>
</ul>
</section>
<section id="k-nearest-neighbors-classifier-build-model" class="slide level2">
<h2><span class="r-fit-text">K-Nearest Neighbors Classifier: Build Model</span></h2>
<ul>
<li><strong>Response</strong> (<span class="math inline">\(Y\)</span>): <code>default</code></li>
<li><strong>Predictor</strong> (<span class="math inline">\(X\)</span>): <code>balance</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="fu">library</span>(caret)   <span class="co"># load package 'caret'</span></span>
<span id="cb3-2"><a href=""></a></span>
<span id="cb3-3"><a href=""></a>knnfit <span class="ot">&lt;-</span> <span class="fu">knn3</span>(default <span class="sc">~</span> balance, <span class="at">data =</span> Default, <span class="at">k =</span> <span class="dv">10</span>)   <span class="co"># fit 10-nn model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-nearest-neighbors-classifier-predictions" class="slide level2 smaller">
<h2><span class="r-fit-text">K-Nearest Neighbors Classifier: Predictions</span></h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Probabilities</a></li><li><a href="#tabset-1-2">Class labels</a></li><li><a href="#tabset-1-3">Threshold</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a>knn_prob_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(knnfit, <span class="at">newdata =</span> Default, <span class="at">type =</span> <span class="st">"prob"</span>)   <span class="co"># obtain predictions as probabilities</span></span>
<span id="cb4-2"><a href=""></a><span class="fu">head</span>(knn_prob_preds) <span class="sc">|&gt;</span> <span class="co"># predicted probabilities for first six observations</span></span>
<span id="cb4-3"><a href=""></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">No</th>
<th style="text-align: right;">Yes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-1-2">
<ul>
<li>Predicts class w/ maximum probability</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a>knn_class_preds_1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(knnfit, <span class="at">newdata =</span> Default, <span class="at">type =</span> <span class="st">"class"</span>)   <span class="co"># obtain class label predictions directly</span></span>
<span id="cb5-2"><a href=""></a><span class="fu">head</span>(knn_class_preds_1) <span class="sc">|&gt;</span>   <span class="co"># predicted class labels for first six observations</span></span>
<span id="cb5-3"><a href=""></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-1-3">
<ul>
<li>More effective when one class is more important and/or classes of imbalanced</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a>knn_prob_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(knnfit, <span class="at">newdata =</span> Default, <span class="at">type =</span> <span class="st">"prob"</span>)   <span class="co"># obtain predictions as probabilities</span></span>
<span id="cb6-2"><a href=""></a>threshold <span class="ot">&lt;-</span> <span class="fl">0.25</span>   <span class="co"># set threshold</span></span>
<span id="cb6-3"><a href=""></a>knn_class_preds_2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(knn_prob_preds[,<span class="dv">2</span>] <span class="sc">&gt;</span> threshold, <span class="st">"Yes"</span>, <span class="st">"No"</span>))    <span class="co"># obtain predictions as class labels</span></span>
<span id="cb6-4"><a href=""></a><span class="fu">head</span>(knn_class_preds_2) <span class="sc">|&gt;</span>   <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="k-nearest-neighbors-classifier-performance" class="slide level2 smaller">
<h2>K-Nearest Neighbors Classifier: Performance</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="co"># use the following code only when all predictions are from the same class</span></span>
<span id="cb7-2"><a href=""></a><span class="co"># levels(knn_class_preds_1) = c("No", "Yes")</span></span>
<span id="cb7-3"><a href=""></a></span>
<span id="cb7-4"><a href=""></a><span class="fu">confusionMatrix</span>(<span class="at">data =</span> knn_class_preds_1, <span class="at">reference =</span> Default<span class="sc">$</span>default, <span class="at">positive =</span> <span class="st">"Yes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   No  Yes
       No  9618  217
       Yes   49  116
                                          
               Accuracy : 0.9734          
                 95% CI : (0.9701, 0.9765)
    No Information Rate : 0.9667          
    P-Value [Acc &gt; NIR] : 6.465e-05       
                                          
                  Kappa : 0.4538          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.3483          
            Specificity : 0.9949          
         Pos Pred Value : 0.7030          
         Neg Pred Value : 0.9779          
             Prevalence : 0.0333          
         Detection Rate : 0.0116          
   Detection Prevalence : 0.0165          
      Balanced Accuracy : 0.6716          
                                          
       'Positive' Class : Yes             
                                          </code></pre>
</div>
</div>
</section>
<section id="confusion-matrix-terms" class="slide level2">
<h2>Confusion Matrix Terms</h2>
<table class="caption-top">
<colgroup>
<col style="width: 40%">
<col style="width: 27%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Actual Positive/Event</th>
<th style="text-align: center;">Actual Negative/Non-event</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Predicted Positive/Event</strong></td>
<td style="text-align: center;">True Negative</td>
<td style="text-align: center;">False Positive</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Predicted Negative/Non-event</strong></td>
<td style="text-align: center;">False Negative</td>
<td style="text-align: center;">True Positive</td>
</tr>
</tbody>
</table>
</section>
<section id="roc-curve-and-auc" class="slide level2">
<h2>ROC Curve and AUC</h2>
<ul>
<li><strong>ROC (Receiver Operating Characteristics) curve</strong>: popular graphic for comparing different classifiers across all possible thresholds
<ul>
<li>Plots the Specificity (1-false positive rate) along the x-axis and the Sensitivity (true positive rate) along the y-axis</li>
</ul></li>
<li><strong>AUC</strong>: area under the AUC curve
<ul>
<li>Ideal ROC curve will hug the top left corner</li>
</ul></li>
</ul>
</section>
<section id="roc-curve-and-auc-1" class="slide level2 smaller">
<h2>ROC Curve and AUC</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="fu">library</span>(pROC)   <span class="co"># functions for computing ROC and AUC</span></span>
<span id="cb9-2"><a href=""></a></span>
<span id="cb9-3"><a href=""></a><span class="co"># create object for ROC curve for KNN fit</span></span>
<span id="cb9-4"><a href=""></a>roc_object_knn <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> Default<span class="sc">$</span>default, </span>
<span id="cb9-5"><a href=""></a>                      <span class="at">predictor =</span> knn_prob_preds[,<span class="dv">2</span>])</span>
<span id="cb9-6"><a href=""></a><span class="fu">ggroc</span>(roc_object_knn)   <span class="co"># plot ROC curve</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="fu">auc</span>(roc_object_knn)   <span class="co"># obtain AUC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.9739</code></pre>
</div>
</div>
<img data-src="Slides4_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"></section>
<section>
<section id="logistic-regression" class="title-slide slide level1 center">
<h1>Logistic Regression</h1>

</section>
<section id="classes-as-numbers" class="slide level2 smaller">
<h2>Classes as numbers</h2>
<ul>
<li>Some functions require categorical response to be input using numeric values (e.g.&nbsp;0/1)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="fu">library</span>(janitor) <span class="co"># for next contingency tables</span></span>
<span id="cb12-2"><a href=""></a>Default<span class="sc">$</span>default_id <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Default<span class="sc">$</span>default <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)   <span class="co"># create 0/1 variable</span></span>
<span id="cb12-3"><a href=""></a>Default <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a href=""></a>  <span class="fu">tabyl</span>(default, default_id) <span class="sc">|&gt;</span> <span class="co"># create contingency table </span></span>
<span id="cb12-5"><a href=""></a>  <span class="fu">kable</span>() <span class="co"># make it looks nice</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">default</th>
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">9667</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">333</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="why-not-linear-regression" class="slide level2 smaller">
<h2>Why Not Linear Regression?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a>lrfit <span class="ot">&lt;-</span> <span class="fu">lm</span>(default_id <span class="sc">~</span> balance, <span class="at">data =</span> Default)   <span class="co"># fit SLR</span></span>
<span id="cb13-2"><a href=""></a><span class="fu">summary</span>(lrfit<span class="sc">$</span>fitted.values)  <span class="co"># summary of y_hats</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.07519 -0.01263  0.03178  0.03330  0.07628  0.26953 </code></pre>
</div>
</div>

<img data-src="Slides4_files/figure-revealjs/unnamed-chunk-12-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><ul>
<li>Linear regression: does not model probabilities well
<ul>
<li>might produce probabilities less than zero or bigger than one</li>
<li>treats increase from 0.41 to 0.5 as same as 0.01 to 0.1 (bad)</li>
</ul></li>
</ul>
</section>
<section id="why-not-linear-regression-1" class="slide level2">
<h2>Why Not Linear Regression?</h2>
<p>Suppose we have a response, <span class="math display">\[Y=\begin{cases}
1 &amp; \text{if stroke} \\
2 &amp; \text{if drug overdose} \\
3  &amp; \text{if epileptic seizure}
\end{cases}\]</span></p>
<ul>
<li>Linear regression suggests an ordering, and in fact implies that the differences between classes have meaning
<ul>
<li>e.g.&nbsp;drug overdose <span class="math inline">\(-\)</span> stroke <span class="math inline">\(= 1\)</span>? ü§î</li>
</ul></li>
</ul>
</section>
<section id="logistic-regression-1" class="slide level2 smaller">
<h2>Logistic Regression</h2>
<p>Consider a one-dimensional binary classification problem:</p>
<ul>
<li>Transform the linear model <span class="math inline">\(\beta_0 + \beta_1 \ X\)</span> so that the output is a probability</li>
<li>Use <strong>logistic</strong> or <strong>sigmoid</strong> function: <span class="math display">\[g(t)=\dfrac{e^t}{1+e^t} \ \ \ \text{for} \ t \in \mathcal{R}\]</span></li>
<li>Then: <span class="math display">\[p(X)=P(Y=1|X)=g\left(\beta_0 + \beta_1 \ X\right)=\dfrac{e^{\beta_0 + \beta_1 \ X}}{1+e^{\beta_0 + \beta_1 \ X}}\]</span></li>
</ul>
</section>
<section id="other-important-quantities" class="slide level2">
<h2>Other important quantities</h2>
<ul>
<li><strong>Odds</strong>: <span class="math inline">\(\dfrac{p(x)}{1-p(x)}\)</span></li>
<li><strong>Log-Odd</strong>: <span class="math inline">\(\log\left(\dfrac{p(x)}{1-p(x)}\right) = \beta_0 + \beta_1 \ X\)</span>
<ul>
<li>Linear function of predictors</li>
</ul></li>
<li><strong>Inverse Logit</strong> (sometimes called <strong>expit</strong>): <span class="math display">\[\log \left(\dfrac{p(X)}{1-p(X)}\right) = \beta_0 + \beta_1 \ X\]</span></li>
</ul>
</section>
<section id="logistic-regression-2" class="slide level2">
<h2>Logistic Regression</h2>

<img data-src="Slides4_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="fitting-the-model" class="slide level2">
<h2>Fitting the model</h2>
<p>Fitting a logistic regression model with <code>default</code> as the response and <code>balance</code> as the predictor:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" data-code-line-numbers="|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a><span class="fu">library</span>(broom) <span class="co">#for formatting model output</span></span>
<span id="cb15-2"><a href=""></a>logregfit <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> balance, <span class="at">data =</span> Default, <span class="at">family =</span> binomial)   <span class="co"># fit logistic regression model</span></span>
<span id="cb15-3"><a href=""></a><span class="fu">tidy</span>(logregfit)   <span class="co"># obtain results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 √ó 5
  term         estimate std.error statistic   p.value
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept) -10.7      0.361        -29.5 3.62e-191
2 balance       0.00550  0.000220      25.0 1.98e-137</code></pre>
</div>
</div>
</section>
<section id="interpreting-coefficients" class="slide level2">
<h2>Interpreting Coefficients</h2>
<ul>
<li>As <span class="math inline">\(X\)</span> increases by 1, the log-odds increase by<span class="math inline">\(\hat{\beta}_1\)</span>
<ul>
<li>I.e. probability of default increases but NOT linearly</li>
<li>Change in the probability of default due to a one-unit change in balance depends on the current balance value</li>
</ul></li>
</ul>
</section>
<section id="interpreting-coefficients-1" class="slide level2">
<h2>Interpreting Coefficients</h2>

<img data-src="Slides4_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section id="making-predictions-theory" class="slide level2 smaller">
<h2>Making predictions: Theory</h2>
<p>For <code>balance</code>=$700,</p>
<div>
<ul>
<li class="fragment"><span class="math display">\[\hat{p}(X)=\dfrac{e^{\hat{\beta}_0+\hat{\beta}_1 X}}{1+e^{\hat{\beta}_0+\hat{\beta}_1 X}}=\dfrac{e^{-10.65 + (0.005499 \times 700)}}{1+e^{-10.65 + (0.005499 \times 700)}}=0.0011\]</span></li>
<li class="fragment"><span class="math display">\[\textbf{Odds}(X) = \dfrac{\hat{p}(X)}{1-\hat{p}(X)} = \dfrac{0.0011}{1-0.0011}\approx 0.0011\]</span></li>
<li class="fragment"><span class="math display">\[\textbf{Log-Odds}(X)=\log\left(\dfrac{\hat{p}(X)}{1-\hat{p}(X)}\right) = \log(0.0011) = -6.80\]</span></li>
</ul>
</div>
</section>
<section id="making-predictions-in-r" class="slide level2">
<h2>Making predictions in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a><span class="fu">predict</span>(logregfit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">balance =</span> <span class="dv">700</span>))   <span class="co"># obtain log-odds predictions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
-6.802089 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a><span class="fu">predict</span>(logregfit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">balance =</span> <span class="dv">700</span>), <span class="at">type =</span> <span class="st">"response"</span>)   <span class="co"># obtain probability predictions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1 
0.001110217 </code></pre>
</div>
</div>
</section>
<section id="using-a-threshold" class="slide level2 smaller">
<h2>Using a threshold</h2>
<ul>
<li>Step 1: Predict <strong>probabilities</strong> for all observations</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a>logreg_prob_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(logregfit, <span class="at">newdata =</span> Default, <span class="at">type =</span> <span class="st">"response"</span>)   <span class="co"># obtain probability predictions</span></span>
<span id="cb21-2"><a href=""></a><span class="fu">head</span>(logreg_prob_preds) <span class="sc">|&gt;</span>    <span class="co"># predicted probabilities for first six observations</span></span>
<span id="cb21-3"><a href=""></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0013057</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0021126</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0085947</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0004344</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0017770</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0037042</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="using-a-threshold-1" class="slide level2 smaller">
<h2>Using a threshold</h2>
<ul>
<li>Step 1: Predict <strong>probabilities</strong> for all observations</li>
<li>Step 2: Set a threshold to obtain <strong>class labels</strong> (0.5 below)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a>threshold <span class="ot">&lt;-</span> <span class="fl">0.5</span>   <span class="co"># set threshold</span></span>
<span id="cb22-2"><a href=""></a>logreg_class_preds <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(logreg_prob_preds <span class="sc">&gt;</span> threshold, <span class="st">"Yes"</span>, <span class="st">"No"</span>))   <span class="co"># obtain class predictions</span></span>
<span id="cb22-3"><a href=""></a><span class="fu">head</span>(logreg_class_preds) <span class="sc">|&gt;</span>    <span class="co"># predicted class labels for first six observations</span></span>
<span id="cb22-4"><a href=""></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="assessing-performance" class="slide level2 smaller">
<h2>Assessing Performance</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a><span class="co"># use the following code only when all predictions are from the same class</span></span>
<span id="cb23-2"><a href=""></a><span class="co"># levels(logreg_class_preds) = c("No", "Yes")</span></span>
<span id="cb23-3"><a href=""></a></span>
<span id="cb23-4"><a href=""></a><span class="fu">confusionMatrix</span>(<span class="at">data =</span> logreg_class_preds, <span class="at">reference =</span> Default<span class="sc">$</span>default, <span class="at">positive =</span> <span class="st">"Yes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   No  Yes
       No  9625  233
       Yes   42  100
                                          
               Accuracy : 0.9725          
                 95% CI : (0.9691, 0.9756)
    No Information Rate : 0.9667          
    P-Value [Acc &gt; NIR] : 0.0004973       
                                          
                  Kappa : 0.4093          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.3003          
            Specificity : 0.9957          
         Pos Pred Value : 0.7042          
         Neg Pred Value : 0.9764          
             Prevalence : 0.0333          
         Detection Rate : 0.0100          
   Detection Prevalence : 0.0142          
      Balanced Accuracy : 0.6480          
                                          
       'Positive' Class : Yes             
                                          </code></pre>
</div>
</div>
</section>
<section id="roc-curve-and-auc-2" class="slide level2 smaller">
<h2>ROC Curve and AUC</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a><span class="fu">library</span>(pROC)   <span class="co"># load library</span></span>
<span id="cb25-2"><a href=""></a></span>
<span id="cb25-3"><a href=""></a><span class="co"># create object for ROC curve</span></span>
<span id="cb25-4"><a href=""></a></span>
<span id="cb25-5"><a href=""></a>roc_object <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> Default<span class="sc">$</span>default, <span class="at">predictor =</span> logreg_prob_preds)</span>
<span id="cb25-6"><a href=""></a><span class="fu">ggroc</span>(roc_object, <span class="at">col =</span> <span class="st">"red"</span>)   <span class="co"># plot ROC curve</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a><span class="fu">auc</span>(roc_object)   <span class="co"># obtain AUC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.948</code></pre>
</div>
</div>
<img data-src="Slides4_files/figure-revealjs/unnamed-chunk-20-1.png" width="960" class="r-stretch"></section>
<section id="logistic-regression-vs-knn" class="slide level2 smaller">
<h2>Logistic Regression vs KNN</h2>
<ul>
<li>Logistic regression <span class="math inline">\(\implies\)</span> parametric , KNN <span class="math inline">\(\implies\)</span> non-parametric.</li>
<li>Logistic regression <span class="math inline">\(\implies\)</span> only for classification problems (<span class="math inline">\(Y\)</span> categorical), KNN <span class="math inline">\(\implies\)</span> both regression and classification.</li>
<li>Logistic regression is interpretable, KNN is not.</li>
<li>Logistic regression allows qualitative predictors. Euclidean distance with KNN does not allow for qualitative predictors.</li>
<li>Prediction: KNN can be pretty good for small <span class="math inline">\(p\)</span>, that is, <span class="math inline">\(p \le 4\)</span> and large <span class="math inline">\(n\)</span>. Performance of KNN deteriorates as <span class="math inline">\(p\)</span> increases - curse of dimensionality.</li>
</ul>
</section>
<section id="decision-boundaries-simulated-observations" class="slide level2">
<h2><span class="r-fit-text">Decision Boundaries: Simulated observations</span></h2>

<img data-src="Slides4_files/figure-revealjs/unnamed-chunk-21-1.png" width="960" class="r-stretch"></section>
<section id="the-machine-learning-process" class="slide level2">
<h2>The Machine Learning Process</h2>
<!-- For the next 2-3 class periods, we are going to discuss the overall ML process. Note that, the procedures we will discuss are not ML models, rather the models go through this process to obtain the best (optimal) predictive model. -->
<!-- **Ames Housing dataset** -->
<!-- ```{r,message=FALSE} -->
<!-- ames <- readRDS("AmesHousing.rds")   # load dataset -->
<!-- ``` -->
<!-- ```{r} -->
<!-- # we won't use the entire dataset now (that's for later) -->
<!-- # select the variables to work with for this class (04/18) -->
<!-- ames <- ames %>% select(Sale_Price, Garage_Area, Year_Built)  -->
<!-- ``` -->
<!-- ## Exploratory Data Analysis -->
<!-- **Ames Housing dataset** -->
<!-- ```{r} -->
<!-- summary(ames)   # summary of the variables -->
<!-- ``` -->
<!-- ## Exploratory Data Analysis -->
<!-- **Ames Housing dataset** -->
<!-- ```{r, fig.align='center'} -->
<!-- library(GGally) -->
<!-- ggpairs(ames)   # correlation plot -->
<!-- ``` -->
<!-- ## Data Splitting -->
<!-- Available data split into **training** and **test** datasets. -->
<!-- * **Training set:** these data are used to develop feature sets, train our algorithms, tune hyperparameters, compare models, and all of the other activities required to choose an optimal model. -->
<!-- * **Test set:** having chosen a final optimal model, these data are used to obtain an unbiased estimate of the model‚Äôs performance. -->
<!-- **It is critical that the test set not be used prior to selecting your final model.** Assessing results on the test set prior to final model selection biases the model selection process since the testing data will have become part of the model development process. -->
<!-- ## Data Splitting -->
<!-- ```{r, message = FALSE} -->
<!-- # split data -->
<!-- set.seed(041824)  # fix the random number generator for reproducibility -->
<!-- library(caret)  # load library -->
<!-- # split available data into 80% training and 20% test datasets -->
<!-- train_index <- createDataPartition(y = ames$Sale_Price, p = 0.8, list = FALSE)  -->
<!-- ames_train <- ames[train_index,]   # training data -->
<!-- ames_test <- ames[-train_index,]   # test data -->
<!-- ``` -->
<!-- <!-- ## Resampling Methods -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r} -->
<p>‚Äì&gt; <!-- <!-- # load required packages --> ‚Äì&gt; <!-- <!-- library(tidyverse) --> ‚Äì&gt; <!-- <!-- library(caret) --> ‚Äì&gt; <!-- <!-- library(ISLR) --> ‚Äì&gt;</p>
<!-- <!-- data("Auto")   # load 'Auto' daatset -->
<p>‚Äì&gt;</p>
<!-- <!-- # split available data into training and test data -->
<p>‚Äì&gt;</p>
<!-- <!-- set.seed(04192022)   # fix the random number generator for reproducibility -->
<p>‚Äì&gt;</p>
<!-- <!-- # response: 'mpg' -->
<p>‚Äì&gt; <!-- <!-- train_index <- createDataPartition(Auto$mpg, p = 0.8, list = FALSE) # split available data into 80% training and 20% test datasets --> ‚Äì&gt;</p>
<!-- <!-- Auto_train <- Auto[train_index,]   # training data, we will work with this to choose our final model -->
<p>‚Äì&gt;</p>
<!-- <!-- Auto_test <- Auto[-train_index,]   # test data, KEEP IT ASIDE, use only after choosing final model -->
<p>‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- ## Resampling Methods -->
<!-- * **Idea:** Repeatedly draw samples from the training data and refit a model on each sample, and evaluate its performance on the other parts. -->
<!-- * **Objective:** To obtain additional information about the fitted model. -->
<!-- * **Cross-Validation (CV)** is probably the most widely used resampling method. It is a general approach that can be applied to almost any statistical learning method. -->
<!-- ## Cross-Validation (CV) -->
<!-- Used for -->
<!-- * **model selection**: select the optimum level of flexibility (tune hyperparameters) or compare different models to choose the best one -->
<!-- * **model assessment**: evaluate the performance of a model (estimate the error and variability) -->
<!-- We will talk about -->
<!-- <!-- * Validation Set Approach -->
<p>‚Äì&gt;</p>
<!-- * Leave-One-Out Cross-Validation (LOOCV) -->
<!-- * $k$-Fold Cross-Validation -->
<!-- <!-- ## Training Error vs Test Error -->
<p>‚Äì&gt;</p>
<!-- <!-- * **Training Error**: Calculated by applying the statistical learning method to the observations used in its training. -->
<p>‚Äì&gt;</p>
<!-- <!-- * **Test Error**: Average error that results from using a -->
<p>‚Äì&gt; <!-- <!-- statistical learning method to predict the response on a new unseen observation. --> ‚Äì&gt;</p>
<!-- <!-- **Test Error Estimates** -->
<p>‚Äì&gt;</p>
<!-- <!-- * From a large designated test set. -->
<p>‚Äì&gt;</p>
<!-- <!-- * Making a mathematical adjustment to the training error. (Chapter 6) -->
<p>‚Äì&gt;</p>
<!-- <!-- * By **holding out** a subset of the training dataset, then assessing model performance on the held out observations. -->
<p>‚Äì&gt;</p>
<!-- <!-- ## Training Error vs Test Error -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r , echo=FALSE,  fig.align='center', out.width = '90%'} -->
<p>‚Äì&gt; <!-- <!-- knitr::include_graphics("EFT/SL_C5_1.PNG") --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## Validation Set Approach -->
<p>‚Äì&gt;</p>
<!-- <!-- * Randomly divide the available set of observations into: a **training set** and a **validation/hold-out set**. -->
<p>‚Äì&gt;</p>
<!-- <!-- * Model fit on the training set. Fitted model is used to predict the responses for the observations in the -->
<p>‚Äì&gt; <!-- <!-- validation set. --> ‚Äì&gt;</p>
<!-- <!-- ```{r , echo=FALSE,  fig.align='center', out.width = '90%'} -->
<p>‚Äì&gt; <!-- <!-- knitr::include_graphics("EFT/5.1.PNG") --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## Validation Set Approach -->
<p>‚Äì&gt;</p>
<!-- <!-- **Auto dataset** -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r, echo=FALSE, fig.align='center'} -->
<p>‚Äì&gt; <!-- <!-- data("Auto") --> ‚Äì&gt; <!-- <!-- plot(Auto$horsepower,Auto$mpg,ylab="mpg",xlab="horsepower") --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- Randomly split the 392 observations into two sets, a training set containing 196 data points, and a validation set containing the remaining 196 observations. -->
<p>‚Äì&gt;</p>
<!-- <!-- ## Validation Set Approach -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r , echo=FALSE,  fig.align='center', out.width = '90%'} -->
<p>‚Äì&gt; <!-- <!-- knitr::include_graphics("EFT/5.2.PNG") --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- Potential drawbacks: -->
<p>‚Äì&gt;</p>
<!-- <!-- * The validation set estimate of the test error can be highly variable. -->
<p>‚Äì&gt;</p>
<!-- <!-- * Only a subset of the observations (those that are in the training set) are used to fit the model. This suggests that the validation set error may tend to overestimate the test error for the model fit on the entire data set. -->
<p>‚Äì&gt;</p>
<!-- <!-- * Yields different results due to randomness in training and validation datasets. -->
<p>‚Äì&gt;</p>
<!-- ## Leave-One-Out Cross-Validation (LOOCV) -->
<!-- <!-- * Closely related to the validation set approach. Attempts to address its drawbacks. -->
<p>‚Äì&gt;</p>
<!-- ```{r , echo=FALSE,  fig.align='center', out.width = '70%'} -->
<!-- knitr::include_graphics("EFT/5.3.PNG") -->
<!-- ``` -->
<!-- ## <span style="color:blue">Your Turn!!!</span>  -->
<!-- Suppose you implement LOOCV on a dataset with $n=100$ observations. -->
<!-- 1. What is the size (number of observations) of each training set? -->
<!-- 2. What is the size of each validation set? -->
<!-- 3. How many steps/iterations are required to complete the overall LOOCV process? -->
<!-- <!-- ```{r , echo=FALSE,  fig.align='center', out.width = '30%'} -->
<p>‚Äì&gt; <!-- <!-- knitr::include_graphics("EFT/e5.1.PNG") --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## Leave-One-Out Cross-Validation (LOOCV) -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r, fig.align='center', fig.height=6, fig.width=8} -->
<p>‚Äì&gt; <!-- <!-- # comparing 4 polynomial (regression) models with LOOCV (response: 'mpg', predictor: 'horsepower') --> ‚Äì&gt;</p>
<!-- <!-- ggplot(data = Auto, aes(x = horsepower, y = mpg)) +   # quick visual check -->
<p>‚Äì&gt; <!-- <!--   geom_point() --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## Leave-One-Out Cross-Validation (LOOCV): Implementation -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r,message=FALSE} -->
<p>‚Äì&gt; <!-- <!-- ames <- readRDS("AmesHousing.rds")   # load dataset --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- Consider `Sale_Price` as the response variable. Split the data into training and test data. -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r, message = FALSE} -->
<p>‚Äì&gt; <!-- <!-- set.seed(012423)  # fix the random number generator for reproducibility --> ‚Äì&gt;</p>
<!-- <!-- library(caret)  # load library -->
<p>‚Äì&gt;</p>
<!-- <!-- train_index <- createDataPartition(y = ames$Sale_Price, p = 0.8, list = FALSE) # split available data into 80% training and 20% test datasets -->
<p>‚Äì&gt;</p>
<!-- <!-- ames_train <- ames[train_index,]   # training data, use this dataset to build model -->
<p>‚Äì&gt;</p>
<!-- <!-- ames_test <- ames[-train_index,]   # test data, use this dataset to evaluate model's performance -->
<p>‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## Leave-One-Out Cross-Validation (LOOCV): Implementation -->
<p>‚Äì&gt;</p>
<!-- <!-- Define CV specifications. -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r} -->
<p>‚Äì&gt; <!-- <!-- cv_specs_loocv <- trainControl(method = "LOOCV")   # specify CV method --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- We will compare the following three linear regression models: -->
<p>‚Äì&gt;</p>
<!-- <!-- * with `Garage_Area` as the only predictor; -->
<p>‚Äì&gt;</p>
<!-- <!-- * with `Overall_Qual` as the only predictor; -->
<p>‚Äì&gt;</p>
<!-- <!-- * with `Garage_Area`, `Year_Built`, and `Overall_Qual` as predictors. -->
<p>‚Äì&gt;</p>
<!-- <!-- ## Leave-One-Out Cross-Validation (LOOCV): Implementation -->
<p>‚Äì&gt;</p>
<!-- <!-- Implement LOOCV with the first model. -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r} -->
<p>‚Äì&gt; <!-- <!-- m1 <- train(form = Sale_Price ~ Garage_Area,    # specify model --> ‚Äì&gt; <!-- <!--             data = ames_train,   # specify dataset --> ‚Äì&gt; <!-- <!--             method = "lm",       # specify type of model --> ‚Äì&gt; <!-- <!--             trControl = cv_specs_loocv, # CV specifications --> ‚Äì&gt; <!-- <!--             metric = "RMSE")   # metric to evaluate model --> ‚Äì&gt;</p>
<!-- <!-- m1   # summary of LOOCV -->
<p>‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## Leave-One-Out Cross-Validation (LOOCV): Implementation -->
<p>‚Äì&gt;</p>
<!-- <!-- Implement LOOCV with the second model. -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r} -->
<p>‚Äì&gt; <!-- <!-- m2 <- train(form = Sale_Price ~ Overall_Qual,   --> ‚Äì&gt; <!-- <!--             data = ames_train,           --> ‚Äì&gt; <!-- <!--             method = "lm",               --> ‚Äì&gt; <!-- <!--             trControl = cv_specs_loocv,        --> ‚Äì&gt; <!-- <!--             metric = "RMSE")            --> ‚Äì&gt;</p>
<!-- <!-- m2 -->
<p>‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## Leave-One-Out Cross-Validation (LOOCV): Implementation -->
<p>‚Äì&gt;</p>
<!-- <!-- Implement LOOCV with the third model. -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r} -->
<p>‚Äì&gt; <!-- <!-- m3 <- train(form = Sale_Price ~ Garage_Area + Year_Built + Overall_Qual,   --> ‚Äì&gt; <!-- <!--             data = ames_train, --> ‚Äì&gt; <!-- <!--             method = "lm", --> ‚Äì&gt; <!-- <!--             trControl = cv_specs_loocv, --> ‚Äì&gt; <!-- <!--             metric = "RMSE") --> ‚Äì&gt;</p>
<!-- <!-- m3 -->
<p>‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## Leave-One-Out Cross-Validation (LOOCV): Results -->
<p>‚Äì&gt;</p>
<!-- <!-- Compare LOOCV results for different models. -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r, fig.align='center', fig.height=6, fig.width=8} -->
<p>‚Äì&gt; <!-- <!-- # create data frame to plot results --> ‚Äì&gt;</p>
<!-- <!-- df <- data.frame(model_number = 1:3, RMSE = c(m1$results$RMSE,   -->
<p>‚Äì&gt; <!-- <!--                                              m2$results$RMSE, --> ‚Äì&gt; <!-- <!--                                              m3$results$RMSE)) --> ‚Äì&gt;</p>
<!-- <!-- # plot results from LOOCV -->
<p>‚Äì&gt;</p>
<!-- <!-- ggplot(data = df, aes(x = model_number, y =  RMSE)) +    -->
<p>‚Äì&gt; <!-- <!--   geom_point() + geom_line() --> ‚Äì&gt;</p>
<!-- <!-- ``` -->
<p>‚Äì&gt;</p>
<!-- ## Leave-One-Out Cross-Validation (LOOCV) -->
<!-- **Advantages** -->
<!-- * LOOCV will give approximately unbiased estimates of the test error, since each training set contains $n‚àí1$ observations, which is almost as many as the number of observations in the full training dataset. -->
<!-- <!-- * Has far less bias than the validation set approach, since the training sets (used to fit the model) are almost as big as the original dataset. -->
<p>‚Äì&gt;</p>
<!-- * Performing LOOCV multiple times will always yield the same results. -->
<!-- **Disadvantages** -->
<!-- * Can be potentially expensive to implement, specially for large $n$. -->
<!-- * LOOCV error estimate can have high variance.  -->
<!-- ## $k$-Fold Cross-Validation -->
<!-- * Randomly divide the training data into $k$ groups or **folds** (approximately equal size). -->
<!-- * Consider one of these folds as the validation set. Fit the model on the remaining $k-1$ folds combined, and obtain predictions for the $k^{th}$ fold. Repeat for all $k$ folds. -->
<!-- ```{r , echo=FALSE,  fig.align='center', out.width = '70%'} -->
<!-- knitr::include_graphics("EFT/5.5.PNG") -->
<!-- ``` -->
<!-- ## <span style="color:blue">Your Turn!!!</span>  -->
<!-- Suppose you implement 10-fold CV on a dataset with $n=100$ observations. -->
<!-- 1. What is the size (number of observations) of each training set? -->
<!-- 2. What is the size of each validation set? -->
<!-- 3. How many steps/iterations are required to complete the overall CV process? -->
<!-- ## $k$-Fold Cross-Validation: Implementation -->
<!-- **Ames Housing dataset** -->
<!-- <!-- ```{r,message=FALSE} -->
<p>‚Äì&gt; <!-- <!-- ames <- readRDS("AmesHousing.rds")   # load dataset --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- Consider `Sale_Price` as the response variable. We will compare the following three linear regression models: -->
<!-- * with `Garage_Area` as the only predictor; -->
<!-- * with `Year_Built` as the only predictor; -->
<!-- * with `Garage_Area` and `Year_Built` as predictors. -->
<!-- <!-- ## $k$-Fold Cross-Validation: Implementation -->
<p>‚Äì&gt;</p>
<!-- <!-- **Ames Housing dataset** -->
<p>‚Äì&gt;</p>
<!-- <!-- Split the data into training and test data. -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r, message = FALSE} -->
<p>‚Äì&gt; <!-- <!-- set.seed(042023)  # fix the random number generator for reproducibility --> ‚Äì&gt;</p>
<!-- <!-- library(caret)  # load library -->
<p>‚Äì&gt;</p>
<!-- <!-- train_index <- createDataPartition(y = ames$Sale_Price, p = 0.8, list = FALSE) # split available data into 80% training and 20% test datasets -->
<p>‚Äì&gt;</p>
<!-- <!-- ames_train <- ames[train_index,]   # training data -->
<p>‚Äì&gt;</p>
<!-- <!-- ames_test <- ames[-train_index,]   # test data -->
<p>‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- ## $k$-Fold Cross-Validation: Implementation -->
<!-- **Ames Housing dataset** -->
<!-- Define CV specifications. -->
<!-- ```{r} -->
<!-- cv_specs <- trainControl(method = "repeatedcv",   # CV method -->
<!--                          number = 10,    # number of folds -->
<!--                          repeats = 5)     # number of repeats -->
<!-- ``` -->
<!-- ## $k$-Fold Cross-Validation: Implementation -->
<!-- **Ames Housing dataset** - Implement 10-fold CV with the first model. -->
<!-- ```{r} -->
<!-- set.seed(041824) -->
<!-- m1 <- train(form = Sale_Price ~ Garage_Area,    # specify model -->
<!--             data = ames_train,   # specify dataset -->
<!--             method = "lm",       # specify type of model -->
<!--             trControl = cv_specs, # CV specifications -->
<!--             metric = "RMSE")   # metric to evaluate model -->
<!-- m1   # summary of CV -->
<!-- m1$results  # estimate and variability of metrics -->
<!-- ``` -->
<!-- ## $k$-Fold Cross-Validation: Implementation -->
<!-- **Ames Housing dataset** - Implement 10-fold CV with the second model. -->
<!-- ```{r} -->
<!-- set.seed(041824) -->
<!-- m2 <- train(form = Sale_Price ~ Year_Built,   -->
<!--             data = ames_train,           -->
<!--             method = "lm",               -->
<!--             trControl = cv_specs,        -->
<!--             metric = "RMSE")            -->
<!-- m2 -->
<!-- m2$results -->
<!-- ``` -->
<!-- ## $k$-Fold Cross-Validation: Implementation -->
<!-- **Ames Housing dataset** - Implement 10-fold CV with the third model. -->
<!-- ```{r} -->
<!-- set.seed(041824) -->
<!-- m3 <- train(form = Sale_Price ~ Garage_Area + Year_Built,   -->
<!--             data = ames_train, -->
<!--             method = "lm", -->
<!--             trControl = cv_specs, -->
<!--             metric = "RMSE") -->
<!-- m3 -->
<!-- m3$results -->
<!-- ``` -->
<!-- ## $k$-Fold Cross-Validation: Results  -->
<!-- **Ames Housing dataset** -->
<!-- Compare CV results for different models. -->
<!-- ```{r, fig.align='center', fig.height=6, fig.width=8} -->
<!-- # create data frame to plot results -->
<!-- df <- data.frame(model_number = 1:3, RMSE = c(m1$results$RMSE,   -->
<!--                                              m2$results$RMSE, -->
<!--                                              m3$results$RMSE)) -->
<!-- # plot results from CV -->
<!-- ggplot(data = df, aes(x = model_number, y =  RMSE)) +    -->
<!--   geom_point() + geom_line() -->
<!-- ``` -->
<!-- <!-- ## $k$-Fold Cross-Validation -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r} -->
<p>‚Äì&gt; <!-- <!-- # comparing 4 polynomial (regression) models with k-fold CV (response: 'mpg', predictor: 'horsepower') --> ‚Äì&gt;</p>
<!-- <!-- set.seed(041920221)   # fix the random number generator for reproducibility -->
<p>‚Äì&gt;</p>
<!-- <!-- # CV specifications (method, number of folds k, number of repetitions) -->
<p>‚Äì&gt; <!-- <!-- cv_specs <- trainControl(method = "repeatedcv", number = 10, repeats = 5)  --> ‚Äì&gt;</p>
<!-- <!-- m1 <- train(mpg ~ horsepower,   # model: y = beta_0 + beta_1 x -->
<p>‚Äì&gt; <!-- <!--             data = Auto_train, --> ‚Äì&gt; <!-- <!--             method = "lm", --> ‚Äì&gt; <!-- <!--             trControl = cv_specs, --> ‚Äì&gt; <!-- <!--             metric = "RMSE") --> ‚Äì&gt;</p>
<!-- <!-- m1   # summary of model with LOOCV -->
<p>‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## $k$-Fold Cross-Validation -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r} -->
<p>‚Äì&gt; <!-- <!-- m2 <- train(mpg ~ poly(horsepower,2),   # model: y = beta_0 + beta_1 x + beta_2 x^2 --> ‚Äì&gt; <!-- <!--             data = Auto_train, --> ‚Äì&gt; <!-- <!--             method = "lm", --> ‚Äì&gt; <!-- <!--             trControl = cv_specs, --> ‚Äì&gt; <!-- <!--             metric = "RMSE") --> ‚Äì&gt;</p>
<!-- <!-- m3 <- train(mpg ~ poly(horsepower, 3),   # model: y = beta_0 + beta_1 x + beta_2 x^2 + beta_3 x^3 -->
<p>‚Äì&gt; <!-- <!--             data = Auto_train, --> ‚Äì&gt; <!-- <!--             method = "lm", --> ‚Äì&gt; <!-- <!--             trControl = cv_specs, --> ‚Äì&gt; <!-- <!--             metric = "RMSE") --> ‚Äì&gt;</p>
<!-- <!-- m4 <- train(mpg ~ poly(horsepower, 4),   # model: y = beta_0 + beta_1 x + beta_2 x^2 + beta_3 x^3 + beta_4 x^4 -->
<p>‚Äì&gt; <!-- <!--             data = Auto_train, --> ‚Äì&gt; <!-- <!--             method = "lm", --> ‚Äì&gt; <!-- <!--             trControl = cv_specs, --> ‚Äì&gt; <!-- <!--             metric = "RMSE") --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## $k$-Fold Cross-Validation -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r, fig.align='center', fig.height=6, fig.width=8} -->
<p>‚Äì&gt; <!-- <!-- df <- data.frame(poly_degree = 1:4, RMSE = c(m1$results$RMSE,   # create data frame to plot results --> ‚Äì&gt; <!-- <!--                                              m2$results$RMSE, --> ‚Äì&gt; <!-- <!--                                              m3$results$RMSE, --> ‚Äì&gt; <!-- <!--                                              m4$results$RMSE)) --> ‚Äì&gt;</p>
<!-- <!-- ggplot(data = df, aes(x = poly_degree, y =  RMSE)) +    # plot results from LOOCV -->
<p>‚Äì&gt; <!-- <!--   geom_point() + geom_line() --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- ## Final Model and Prediction Error Estimate -->
<!-- **Ames Housing dataset** -->
<!-- ```{r} -->
<!-- # after choosing final (optimal) model, refit final model using ALL training data -->
<!-- m3$finalModel     -->
<!-- ``` -->
<!-- ```{r} -->
<!-- # obtain estimate of prediction error from test data -->
<!-- final_model_preds <- predict(m3, newdata = ames_test)   # obtain predictions on test data -->
<!-- pred_error_est <- sqrt(mean((ames_test$Sale_Price - final_model_preds)^2))    # calculate RMSE (estimate of prediction error) from test data -->
<!-- pred_error_est   # test set RMSE -->
<!-- ``` -->
<!-- <!-- ## Variable Importance -->
<p>‚Äì&gt;</p>
<!-- <!-- **Ames Housing dataset** -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r, fig.align='center', fig.height=6, fig.width=8} -->
<p>‚Äì&gt; <!-- <!-- # variable importance --> ‚Äì&gt;</p>
<!-- <!-- library(vip) -->
<p>‚Äì&gt;</p>
<!-- <!-- vip(object = m3,         # CV object  -->
<p>‚Äì&gt; <!-- <!--     num_features = 20,   # maximum number of predictors to show importance for --> ‚Äì&gt; <!-- <!--     method = "model")            # model-specific VI scores --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## $k$-Fold Cross-Validation -->
<p>‚Äì&gt;</p>
<!-- <!-- Let $n_i$ be the number of observations in  $i^{th}, (i=1,\ldots,k)$ fold. If $n$ is a multiple of $k$, then $n_i=\frac{n}{k}$. -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r , echo=FALSE,  fig.align='center', out.width = '40%'} -->
<p>‚Äì&gt; <!-- <!-- knitr::include_graphics("EFT/e5.3.PNG") --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- If the folds are not of equal size, -->
<p>‚Äì&gt;</p>
<!-- <!-- $$CV_{(k)}=\displaystyle \sum_{i=1}^k \dfrac{n_i}{n} MSE_{i}$$ -->
<p>‚Äì&gt;</p>
<!-- <!-- A good choice is $k=5$ or $10$. LOOCV is a special case of $k$-fold CV. -->
<p>‚Äì&gt;</p>
<!-- <!-- ## LOOCV and $k$-Fold CV -->
<p>‚Äì&gt;</p>
<!-- <!-- **Auto dataset** -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r , echo=FALSE,  fig.align='center', out.width = '100%'} -->
<p>‚Äì&gt; <!-- <!-- knitr::include_graphics("EFT/5.4.PNG") --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## Performance of LOOCV and $k$-Fold CV -->
<p>‚Äì&gt;</p>
<!-- <!-- <!-- **Figures 2.9-2.11 in Chapter 2** -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r , echo=FALSE,  fig.align='center', out.width = '100%'} -->
<p>‚Äì&gt; <!-- <!-- knitr::include_graphics("EFT/5.6.PNG") --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- ## Bias-Variance Trade-off for LOOCV and $k$-fold CV -->
<!-- * LOOCV has very less bias. Using $k=5$ or $10$ yields more bias than LOOCV. -->
<!-- <!-- , but less than validation set approach. -->
<p>‚Äì&gt;</p>
<!-- * For LOOCV, the error estimates for each fold are highly (positively) correlated. $k$-fold CV error estimates are somewhat less correlated. LOOCV error estimate has higher variance than $k$-fold CV error estimate. -->
<!-- * Typically, $k=5$ or $10$ is chosen. -->
<!-- <!-- ## CV to Tune Hyperparameter -->
<p>‚Äì&gt;</p>
<!-- <!-- **Auto dataset** -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r,message=FALSE} -->
<p>‚Äì&gt; <!-- <!-- library(ISLR2)  # load library --> ‚Äì&gt;</p>
<!-- <!-- data("Auto")   # load dataset -->
<p>‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- We will consider `mpg` as the response and `horsepower` as the predictor.  -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r} -->
<p>‚Äì&gt; <!-- <!-- # select the variables to work with --> ‚Äì&gt;</p>
<!-- <!-- Auto <- Auto %>% select(mpg, horsepower) -->
<p>‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## CV to Tune Hyperparameter -->
<p>‚Äì&gt;</p>
<!-- <!-- **Objective**: Find the optimum choice of $K$ in the KNN approach with 5-fold CV repeated 5 times. We will use the following steps. -->
<p>‚Äì&gt;</p>
<!-- <!-- * Perform EDA (Exploratory Data Analysis) -->
<p>‚Äì&gt;</p>
<!-- <!-- * Split the data into training and test data (80-20 split). -->
<p>‚Äì&gt;</p>
<!-- <!-- * Specify CV specifications using **trainControl**. -->
<p>‚Äì&gt;</p>
<!-- <!-- * Create an object **k_grid** using the following code. -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r} -->
<p>‚Äì&gt; <!-- <!-- k_grid <- expand.grid(k = seq(1, 100, by = 1))  # creates a grid of k values to be used (1 to 100 in this case) --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- * Use the **train** function to run CV. Use **method = "knn"**, **tuneGrid = k_grid**, and **metric = "RMSE"**. -->
<p>‚Äì&gt;</p>
<!-- <!-- * Obtain the results and plot them. What is the optimum $k$ chosen? -->
<p>‚Äì&gt;</p>
<!-- <!-- * Create the final model using the optimum $k$ and estimate its prediction error from the test data. -->
<p>‚Äì&gt;</p>
<!-- <!-- ## CV to Tune Hyperparameter: EDA {.smaller} -->
<p>‚Äì&gt;</p>
<!-- <!-- **Auto dataset** -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r} -->
<p>‚Äì&gt; <!-- <!-- summary(Auto)   # summary of the variables --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ```{r, fig.align='center', fig.height=4, fig.width=4} -->
<p>‚Äì&gt; <!-- <!-- library(GGally) --> ‚Äì&gt; <!-- <!-- ggpairs(Auto)    # correlation plot --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## CV to Tune Hyperparameter: Split Data -->
<p>‚Äì&gt;</p>
<!-- <!-- **Auto dataset** -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r, message = FALSE} -->
<p>‚Äì&gt; <!-- <!-- set.seed(041824)  # fix the random number generator for reproducibility --> ‚Äì&gt;</p>
<!-- <!-- library(caret)  # load library -->
<p>‚Äì&gt;</p>
<!-- <!-- train_index <- createDataPartition(y = Auto$mpg, p = 0.8, list = FALSE) # split available data into 80% training and 20% test datasets -->
<p>‚Äì&gt;</p>
<!-- <!-- Auto_train <- Auto[train_index,]   # training data -->
<p>‚Äì&gt;</p>
<!-- <!-- Auto_test <- Auto[-train_index,]   # test data -->
<p>‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## CV to Tune Hyperparameter: Perform CV -->
<p>‚Äì&gt;</p>
<!-- <!-- **Auto dataset** -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r} -->
<p>‚Äì&gt; <!-- <!-- set.seed(041824)  # fix the random number generator for reproducibility --> ‚Äì&gt;</p>
<!-- <!-- # CV specifications -->
<p>‚Äì&gt; <!-- <!-- cv_specs <- trainControl(method = "repeatedcv", number = 5, repeats = 5) --> ‚Äì&gt;</p>
<!-- <!-- # specify grid of 'k' values to search over -->
<p>‚Äì&gt; <!-- <!-- k_grid <- expand.grid(k = seq(1, 100, by = 1)) --> ‚Äì&gt;</p>
<!-- <!-- # train the KNN model using CV  to find optimal 'k' -->
<p>‚Äì&gt; <!-- <!-- knn_cv <- train(form = mpg ~ horsepower, --> ‚Äì&gt; <!-- <!--                  data = Auto_train, --> ‚Äì&gt; <!-- <!--                  method = "knn", --> ‚Äì&gt; <!-- <!--                  trControl = cv_specs, --> ‚Äì&gt; <!-- <!--                  tuneGrid = k_grid, --> ‚Äì&gt; <!-- <!--                  metric = "RMSE") --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## CV to Tune Hyperparameter: Compare CV Results -->
<p>‚Äì&gt;</p>
<!-- <!-- **Auto dataset** -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r, eval=FALSE} -->
<p>‚Äì&gt; <!-- <!-- knn_cv   # CV results, shows RMSE for all K --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ```{r, fig.align='center'} -->
<p>‚Äì&gt; <!-- <!-- ggplot(knn_cv)   # plot CV results for different 'k' --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ## CV to Tune Hyperparameter: Final Model -->
<p>‚Äì&gt;</p>
<!-- <!-- **Auto dataset** -->
<p>‚Äì&gt;</p>
<!-- <!-- ```{r} -->
<p>‚Äì&gt; <!-- <!-- # final model with optimal 'k' chosen from CV --> ‚Äì&gt;</p>
<!-- <!-- knn_cv$bestTune     # optimal value of K -->
<p>‚Äì&gt;</p>
<!-- <!-- knn_cv$finalModel   # final model -->
<p>‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<!-- <!-- ```{r} -->
<p>‚Äì&gt; <!-- <!-- # obtain predictions on test data --> ‚Äì&gt; <!-- <!-- final_model_preds <- predict(knn_cv, newdata = Auto_test) --> ‚Äì&gt;</p>
<!-- <!-- # estimate test set prediction error -->
<p>‚Äì&gt; <!-- <!-- sqrt(mean((Auto_test$mpg - final_model_preds)^2))    # test set RMSE --> ‚Äì&gt; <!-- <!-- ``` --> ‚Äì&gt;</p>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Slides4_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Slides4_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Slides4_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Slides4_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Slides4_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Slides4_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Slides4_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Slides4_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Slides4_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Slides4_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>